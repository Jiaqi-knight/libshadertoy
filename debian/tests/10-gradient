#!/bin/bash

if [ -z "$LIBSHADERTOY_DIR" ]; then
	LIBSHADERTOY_DIR=/usr/share/shadertoy
fi

if [ -z "$CMAKE_EXTRA_OPTS" ]; then
	CMAKE_EXTRA_OPTS=""
fi

# Copy example from datadir
cp -r "$LIBSHADERTOY_DIR/examples" "$AUTOPKGTEST_TMP"
cd "$AUTOPKGTEST_TMP/examples"

# Configure
set -eo pipefail

mkdir build
cd build
cmake $CMAKE_EXTRA_OPTS ..

# Build
make -j VERBOSE=1 example10-gradient

# Execute
./src/10-gradient/example10-gradient
